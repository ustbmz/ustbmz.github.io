<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Vue2/项目部署" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">项目部署 | USTBMZ</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/docs/Vue2/项目部署"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="项目部署 | USTBMZ"><meta data-rh="true" name="description" content="1. 项目部署介绍"><meta data-rh="true" property="og:description" content="1. 项目部署介绍"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/docs/Vue2/项目部署"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/Vue2/项目部署" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/docs/Vue2/项目部署" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="USTBMZ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="USTBMZ Atom Feed"><link rel="stylesheet" href="/assets/css/styles.73cba182.css">
<script src="/assets/js/runtime~main.8d7adb85.js" defer="defer"></script>
<script src="/assets/js/main.84be92f1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="USTBMZ Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="USTBMZ Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">USTBMZ</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" sidebarid="basicSideBar">Basics</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/Css/test">CSS</a></li><li><a class="dropdown__link" href="/docs/JavaScript/test">JavaScript</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" sidebarid="reactSiderBar">React</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/React/1-1.React 基本介绍">React</a></li><li><a class="dropdown__link" href="/docs/React15/1-1.React概述">React15</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" sidebarid="vueSiderBar">Vue</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/Vue2/01">Vue2</a></li><li><a class="dropdown__link" href="/docs/Vue/静态提升">Vue3</a></li></ul></div><a class="navbar__item navbar__link" href="/blog">About</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/USTBMZ" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/核心概念">注入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/组件">组件开发</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/搭建工程">搭建工程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/计算属性">面试题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/组件事件">Pager组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/插槽">插槽</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/路由">路由</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/弹出消息">弹出消息</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/获取数据">获取数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/组件生命周期">组件生命周期</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/自定义指令">定义指令</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/组件混入">组件混入</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/$listeners和v-model">$listeners和v-model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/事件总线">事件总线</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/数据共享">数据共享</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/vuex经典案例">用户模块逻辑示意图</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/打包结果分析">分析打包结果</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/异步组件">异步组件</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/Vue2/项目部署">项目部署</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Vue2/01">前端框架的由来</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">项目部署</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>项目部署</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-项目部署介绍">1. 项目部署介绍<a href="#1-项目部署介绍" class="hash-link" aria-label="Direct link to 1. 项目部署介绍" title="Direct link to 1. 项目部署介绍">​</a></h2>
<p>当我们的项目开发完毕后，我们需要将项目打包、部署到服务器上，供用户来使用。</p>
<p>目前，常见的部署方式有两种：</p>
<ul>
<li>后端部署</li>
<li>前后端分离部署</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-1-后端部署">1-1 后端部署<a href="#1-1-后端部署" class="hash-link" aria-label="Direct link to 1-1 后端部署" title="Direct link to 1-1 后端部署">​</a></h3>
<p>这是最古老的部署方式，也是最常见的一种部署方式。</p>
<p>我们前端只需要将我们的项目打包好，交给后端开发人员即可。后端开发人员会把我们打包好的项目放到后端的静态资源目录里面。</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/XRxfQJns46AedEH.png" alt="image-20210804210004590" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-2-前后端分离部署">1-2 前后端分离部署<a href="#1-2-前后端分离部署" class="hash-link" aria-label="Direct link to 1-2 前后端分离部署" title="Direct link to 1-2 前后端分离部署">​</a></h3>
<p>随着前后端分离开发模式的流行，现在可以采用前后端分离部署的形式。后端部署后端服务器的代码，前端将打包好的资源，部署到前端的服务器上面，用户在做请求的时候，从前端服务器请求静态资源，然后从后端服务器获取数据。</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/Ng9hqpYx63duQ58.png" alt="image-20210804210409646" class="img_ev3q"></p>
<p>目前前端部署静态资源时，大多采用 Node.js 或者 Nginx 来做静态资源部署，我们这里选择 Nginx。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-部署具体流程">2. 部署具体流程<a href="#2-部署具体流程" class="hash-link" aria-label="Direct link to 2. 部署具体流程" title="Direct link to 2. 部署具体流程">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-1-阿里云购买服务器">2-1 阿里云购买服务器<a href="#2-1-阿里云购买服务器" class="hash-link" aria-label="Direct link to 2-1 阿里云购买服务器" title="Direct link to 2-1 阿里云购买服务器">​</a></h3>
<p>首先，我们需要一台服务器，现在流行的云服务器极大的节约了我们部署成本，我们能够很轻松的快速拥有一台服务器。</p>
<p>阿里云：<a href="https://www.aliyun.com/" target="_blank" rel="noopener noreferrer">https://www.aliyun.com/</a></p>
<p>（1）注册账号</p>
<p>（2）选择&quot;云服务器 ECS&quot;，点击查看详情</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/QCEM7qw9Onif4Kb.png" alt="image-20210804232354218" class="img_ev3q"></p>
<p>（3）立即购买</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/cqvRUdoCOLJkVtT.png" alt="image-20210804232443158" class="img_ev3q"></p>
<p>（4）选择&quot;一键购买&quot;</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/5AlbNLOYU2vcVer.png" alt="image-20210804232530827" class="img_ev3q"></p>
<p>镜像选择 CentOS。</p>
<p>进入到 Linux 系统后，使用命令来进行操作，先介绍几个命令：</p>
<p>ls：查看当前目录下的文件有哪些</p>
<p>exit：退出系统</p>
<p>clear：清屏</p>
<p>touch：创建文件，例如 touch 文件名</p>
<p>mkdir：创建目录，例如 mkdir 目录名称</p>
<p>mv：移动目录或者文件，例如 mv 要移动的文件或者目录 要移动到哪儿</p>
<p>rm -rf 要删除的目录或者文件名：删除目录或者文件</p>
<p>本地连接云服务器：ssh -p 22 <a href="mailto:root@xxx.xxx.xxx.xxx" target="_blank" rel="noopener noreferrer">root@xxx.xxx.xxx.xxx</a></p>
<p>具体的操作流程见视频。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-2-安装-nodejs">2-2 安装 Node.js<a href="#2-2-安装-nodejs" class="hash-link" aria-label="Direct link to 2-2 安装 Node.js" title="Direct link to 2-2 安装 Node.js">​</a></h3>
<p>安装 Node.js：<a href="https://help.aliyun.com/document_detail/50775.html" target="_blank" rel="noopener noreferrer">https://help.aliyun.com/document_detail/50775.html</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-3-安装-mongodb">2-3 安装 MongoDB<a href="#2-3-安装-mongodb" class="hash-link" aria-label="Direct link to 2-3 安装 MongoDB" title="Direct link to 2-3 安装 MongoDB">​</a></h3>
<p>安装依赖库：</p>
<p><code>yum -y install pcre*</code></p>
<p><code>yum -y install openssl*</code></p>
<p>安装 MongoDB：</p>
<p>下载：<code>curl -O https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-4.2.1.tgz</code></p>
<p>解压：<code>tar zxvf mongodb-linux-x86_64-4.2.1.tgz</code></p>
<p>移动：<code>mv mongodb-linux-x86_64-4.2.1/ /usr/local/mongodb</code></p>
<p>创建数据文件夹、日志文件和mongo配置文件:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p  </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">usr</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">local</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">usr</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">local</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">usr</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">local</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在配置文件中加入如下代码：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dbpath</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">usr</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">local</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logpath</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">usr</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">local</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">log</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logappend </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">port </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">27017</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fork </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>切换到 mongodb 的 bin 下：</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/N8IV3oWEsUHR2Qx.png" alt="image-20210805093056262" class="img_ev3q"></p>
<p>启动：<code>./mongod --dbpath /usr/local/mongodb/data/db</code></p>
<p><code>mongod -dbpath=/usr/local/mongodb/data/db --bind_ip 0.0.0.0</code></p>
<p>指定所有的 <em>ip</em> 都可以连接上，当然现在只是暂时的，后面项目部署上去后，肯定是要关闭的。</p>
<p>可能遇到的错误以及解决方案：</p>
<p>Segmentation fault (core dumped)：</p>
<p><a href="https://blog.csdn.net/weixin_44320761/article/details/107671990" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_44320761/article/details/107671990</a></p>
<p>error while loading shared libraries: libssl.so.10，既libssl.so.10缺失库文件的解决办法：</p>
<p><a href="https://blog.csdn.net/xcyja/article/details/115357818" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/xcyja/article/details/115357818</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-4-上传服务器代码以及数据库数据">2-4 上传服务器代码以及数据库数据<a href="#2-4-上传服务器代码以及数据库数据" class="hash-link" aria-label="Direct link to 2-4 上传服务器代码以及数据库数据" title="Direct link to 2-4 上传服务器代码以及数据库数据">​</a></h3>
<p>导出数据库的数据，详细参见文档。</p>
<p>如果是 widnows 系统，参阅：<a href="https://www.runoob.com/mongodb/mongodb-mongodump-mongorestore.html" target="_blank" rel="noopener noreferrer">https://www.runoob.com/mongodb/mongodb-mongodump-mongorestore.html</a></p>
<p>接下来，我们需要将打包好的数据库数据压缩包以及服务器代码压缩包（删除 node_modules）上传到云服务器。</p>
<p>windows 系统：可以使用 finalshell（使用方法很简单，安装，连接服务器，将要上传的文件拖动到对应窗口即可）</p>
<p>mac 系统：可以使用自带的 shell 工具。</p>
<p>打开 shell 工具，选择【新建远程连接】</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/FICb6Eo2XHwQZtp.png" alt="image-20210805143549450" class="img_ev3q"></p>
<p>选择【安全文件传输（sftp）】，下面要填写用户名和对应的服务器的 ip 地址</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/pMTtACNaFGS7xul.png" alt="image-20210805143631378" class="img_ev3q"></p>
<p>点击【连接】，如下：</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/Z8zfXSI9teiH14W.png" alt="image-20210805143922456" class="img_ev3q"></p>
<p>使用命令：put 要上传的文件的地址 远程服务器的具体地址</p>
<p>例如：put  /Users/Jie/Desktop/dbData.zip  /usr/local</p>
<p>解压 zip 压缩包命令：unzip 压缩包名</p>
<p>例如：unzip dbData.zip</p>
<p>启动服务器：进入到服务器目录，安装依赖包，npm start 启动即可</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-5-安装-nginx-静态资源服务器">2-5 安装 Nginx 静态资源服务器<a href="#2-5-安装-nginx-静态资源服务器" class="hash-link" aria-label="Direct link to 2-5 安装 Nginx 静态资源服务器" title="Direct link to 2-5 安装 Nginx 静态资源服务器">​</a></h3>
<p>（1）下载依赖</p>
<p><code>yum -y install pcre*</code></p>
<p><code>yum -y install openssl*</code></p>
<p>（2）下载 wget（类似于迅雷，用来下载文件的）</p>
<p><code>yum install wget</code></p>
<p>（3）下载 nginx</p>
<p><code>wget http://nginx.org/download/nginx-1.21.1.tar.gz</code></p>
<p>（4）解压</p>
<p><code>tar zxvf nginx-1.21.1.tar.gz</code></p>
<p>（5）进入到解压后的目录，编译</p>
<p><code>./configure</code></p>
<p>（6）安装</p>
<p><code>make install</code></p>
<p>安装完毕后，会在同级目录生成一个 nginx 的目录，这个才是我们的服务器目录</p>
<p>nginx 常用命令：</p>
<ul>
<li>
<p>nginx：启动</p>
</li>
<li>
<p>nginx -v：查看版本</p>
</li>
<li>
<p>nginx -s stop：停止</p>
</li>
<li>
<p>nginx -s reload：重启</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-6-打包静态资源">2-6 打包静态资源<a href="#2-6-打包静态资源" class="hash-link" aria-label="Direct link to 2-6 打包静态资源" title="Direct link to 2-6 打包静态资源">​</a></h3>
<p>打包前台代码：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>打包后台代码：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm run build</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">prod</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将打包好的前台代码放入 nginx 的 html 目录下，将打包好的后台代码放入到 nginx/html/admin 目录下</p>
<p>修改 nginx 的配置文件，该文件位于 conf 目录下的 nginx.conf，添加代理设置：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token dom variable" style="color:#36acaa">location</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    root   html</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    index  index</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">html</span><span class="token plain"> index</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">htm</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try_files $uri $uri</span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">index</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">html</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">location</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">api </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  proxy_pass http</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">127.0</span><span class="token number" style="color:#36acaa">.0</span><span class="token number" style="color:#36acaa">.1</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">7001</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">location</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">res </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  proxy_pass http</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">127.0</span><span class="token number" style="color:#36acaa">.0</span><span class="token number" style="color:#36acaa">.1</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">7001</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token dom variable" style="color:#36acaa">location</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  proxy_pass http</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">127.0</span><span class="token number" style="color:#36acaa">.0</span><span class="token number" style="color:#36acaa">.1</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">7001</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-7-进程守护">2-7 进程守护<a href="#2-7-进程守护" class="hash-link" aria-label="Direct link to 2-7 进程守护" title="Direct link to 2-7 进程守护">​</a></h3>
<p>在 Linux 中，可以输入：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nohup command </span><span class="token operator" style="color:#393A34">&amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>来把进程挂起，这样即使我们退出了远程连接，也能够继续保持进程。</p>
<p>使用示例：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nohup npm start </span><span class="token operator" style="color:#393A34">&amp;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>挂起进程之后，使用 <em>exit</em> 命令来退出远程连接。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-8-域名映射">2-8 域名映射<a href="#2-8-域名映射" class="hash-link" aria-label="Direct link to 2-8 域名映射" title="Direct link to 2-8 域名映射">​</a></h3>
<p>目前为止，我们的项目就已经部署成功了，但是用 IP 访问不是太友好，所以我们来进行域名的映射。</p>
<p>首先，我们需要购买一个域名。</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/ofxSgLciUPMatjz.png" alt="image-20210805160701936" class="img_ev3q"></p>
<p>购买完成后，点击【管理我的域名】</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/AD8ci2dMkfJrmSn.png" alt="image-20210805160958043" class="img_ev3q"></p>
<p>进去之后，找到要映射的域名，点击【解析】</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/Rpc2o9mIPJaZf1W.png" alt="image-20210805161048749" class="img_ev3q"></p>
<p>进去之后，点击【添加记录】</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/hBcQJPZHzIWmpfk.png" alt="image-20210805161121894" class="img_ev3q"></p>
<p>填写的内容如下：</p>
<p>记录类型选择【A】，主机记录填写【www】，记录值填写【IP 地址】</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/ldToaKW3Mm2sCck.png" alt="image-20210805161215113" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-9-数据库加密">2-9 数据库加密<a href="#2-9-数据库加密" class="hash-link" aria-label="Direct link to 2-9 数据库加密" title="Direct link to 2-9 数据库加密">​</a></h3>
<p>为了权限接入可用，必须确保有一个用户是 <em>userAdmin</em> 或者 <em>userAdminAnyDatabase</em> 的角色在 <em>admin</em> 数据库里。
因此，我们首先创建用户 <em>root</em> 用户在 <em>admin</em> 数据库里，代码如下：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use admin # 切换 admin 数据库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">user</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;root&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">pwd</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;123456&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">roles</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">role</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;userAdminAnyDatabase&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;admin&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>具体操作如下图：</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/498JgDwRFy6rOix.png" alt="image-20210812093119060" class="img_ev3q"></p>
<blockquote>
<p>注：<em>db</em> 可以查看当前所使用的数据库</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/kSbyutizWjBc2po.png" alt="image-20210812093151829" class="img_ev3q"></p>
<p>接下来在其他数据库上面创建用户，但是一定要注意先在 <em>admin</em> 数据库上面使用刚才的超级管理员登录，再进行其他数据库用户创建的创建。</p>
<p>对应代码如下：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use amdin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">auth</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;root&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;123456&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在 <em>mongodb</em> 中 <em>admin</em> 数据库是一个特别的数据库，这个数据库的用户，可以访问 <em>mongodb</em> 中的所有数据库。</p>
<p>如果要为其他数据库设置用户，步骤也是一样的，首先切换到其他数据库，然后创建用户</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use 数据库名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">user</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;用户名&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">pwd</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;密码&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">roles</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">role</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;read&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;数据库名&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">role</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;readWrite&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;数据库名&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/caZf5ezyi6OFjQ3.png" alt="image-20210812093225943" class="img_ev3q"></p>
<p>最后执行</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">auth</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;用户名&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;密码&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/sb4QRj1EczUTglu.png" alt="image-20210812093306323" class="img_ev3q"></p>
<p>返回 <em>1</em>，说明登录成功。</p>
<p>至此，我们就在数据库上面添加了一个用户，并且设置了账号和密码。</p>
<p>修改 <em>mongodb</em> 的配置文件：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">systemLog</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">destination</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> file #日志输出方式。file</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">syslog</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">如果是file，需指定path，默认是输出到标准输出流中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">usr</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">local</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">log</span><span class="token plain">  #日志路径</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">logAppend</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> #启动时，日志追加在已有日志文件内还是备份旧日志后，创建新文件记录日志</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 默认</span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">net</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">port</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">27017</span><span class="token plain"> #监听端口，默认</span><span class="token number" style="color:#36acaa">27017</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">bindIp</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token number" style="color:#36acaa">.0</span><span class="token number" style="color:#36acaa">.0</span><span class="token plain"> #绑定监听的ip，设置为</span><span class="token number" style="color:#36acaa">127.0</span><span class="token number" style="color:#36acaa">.0</span><span class="token number" style="color:#36acaa">.1</span><span class="token plain">时，只会监听本机</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">maxIncomingConnections</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">65536</span><span class="token plain"> #最大连接数，可接受的连接数还受限于操作系统配置的最大连接数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">wireObjectCheck</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> #校验客户端的请求，防止错误的或无效</span><span class="token constant" style="color:#36acaa">BSON</span><span class="token plain">插入</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">多层文档嵌套的对象会有轻微性能影响</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">默认</span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">processManagement</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">fork</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain">  # 后台运行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">security</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">authorization</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> enabled  # enabled</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">disabled #开启客户端认证</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">storage</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">dbPath</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">usr</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">local</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">db  # 数据库地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">journal</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">enabled</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> #启动journal</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">64</span><span class="token plain">位系统默认开启，</span><span class="token number" style="color:#36acaa">32</span><span class="token plain">位默认关闭</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后在启动 <em>mongodb</em> 的时候，指定读取配置文件：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongod </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">config </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">usr</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">local</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>查看进程的 PID：</p>
<p>lsof -i:端口号</p>
<p>例如：lsof -i:27017</p>
<p>停止进程</p>
<p>kill -9 PID</p>
<p>例如：kill -9 24311</p>
</blockquote>
<p>远程数据库连接时，需要输入账号以及密码。</p>
<p>接下来就是在你的服务器端代码里面，使用 <em>mongoose</em> 的时候，连接的是有权限的数据库，所以需要修改连接字符串：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">连接字符串修改为：mongodb</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">username</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">password@ip</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">port</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">database</span><span class="token operator" style="color:#393A34">?</span><span class="token plain">authSource</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">例如：mongodb</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">testadmin</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">testadmin123@</span><span class="token number" style="color:#36acaa">88.888</span><span class="token number" style="color:#36acaa">.88</span><span class="token number" style="color:#36acaa">.888</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">27017</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">testmongodb</span><span class="token operator" style="color:#393A34">?</span><span class="token plain">authSource</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">admin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 参数说明</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># testadmin 用户名称</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># testadmin123 用户密码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># </span><span class="token number" style="color:#36acaa">88.888</span><span class="token number" style="color:#36acaa">.88</span><span class="token number" style="color:#36acaa">.888</span><span class="token plain"> 服务器地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># </span><span class="token number" style="color:#36acaa">27017</span><span class="token plain"> 端口号码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># testmongodb 连接的数据库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># </span><span class="token operator" style="color:#393A34">?</span><span class="token plain">authSource</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">admin 权限来源</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 至此，可以通过 mongoose 连接数据库</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>-<em>EOF</em>-</p>
<h1>项目部署补充内容</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="数据库恢复数据">数据库恢复数据<a href="#数据库恢复数据" class="hash-link" aria-label="Direct link to 数据库恢复数据" title="Direct link to 数据库恢复数据">​</a></h2>
<p>首先电脑上没安装 mongodb 的同学，需要去官网下载一下 mongodb</p>
<p>官网地址：<em><a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">https://www.mongodb.com/</a></em></p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/HyAm5GOuaWlN1BC.png" alt="image-20220329143201284" class="img_ev3q"></p>
<p>然后根据你自己的操作系统下载对应的版本，截止到谢老师录制这个视频的时候，最新的为 5.0.6</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/4Bbn5MStcu826Gv.png" alt="image-20220329143319208" class="img_ev3q"></p>
<p>注意，新的 mongodb 不会包含以前的一大堆命令，所以我们要恢复数据库，还需要下载命令</p>
<p>仍然是根据你自己的操作系统下载对应的工具包</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/849XOJcFYtDhUe6.png" alt="image-20220329143506768" class="img_ev3q"></p>
<p>最后根据谢老师写的 mongodb 文档中的恢复数据库的命令，进行恢复即可。</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/KvMf3EbdHXjNkVU.png" alt="image-20220329143632372" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="centos-linux停止维护后如何应对">CentOS Linux停止维护后如何应对？<a href="#centos-linux停止维护后如何应对" class="hash-link" aria-label="Direct link to CentOS Linux停止维护后如何应对？" title="Direct link to CentOS Linux停止维护后如何应对？">​</a></h2>
<p>CentOS官方已计划停止维护CentOS Linux项目，阿里云上CentOS Linux公共镜像来源于CentOS官方，当CentOS Linux停止维护后，阿里云将会同时停止对该操作系统的支持。</p>
<p>具体参阅：<em><a href="https://help.aliyun.com/document_detail/347584.html?spm=5176.11346930configuration.0.0.284e5ca3pjg7iY" target="_blank" rel="noopener noreferrer">https://help.aliyun.com/document_detail/347584.html?spm=5176.11346930configuration.0.0.284e5ca3pjg7iY</a></em></p>
<p>这里谢老师选择了它家自研的 Alibaba Cloud Linux 2.1903 LTS 64，因为做了很多优化，而且全面兼容RHEL/CentOS生态，并且这也是官方所提供的一个替代方案</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/yV9KAmnFkYL7TlC.png" alt="image-20220329115351056" class="img_ev3q"></p>
<p>修改了操作系统镜像后，安装 Node.js 没有一点问题。</p>
<p>参阅：<em><a href="https://help.aliyun.com/document_detail/172788.html" target="_blank" rel="noopener noreferrer">https://help.aliyun.com/document_detail/172788.html</a></em> 的部署Node.js环境（Alibaba Cloud Linux 2）</p>
<p>安装 Node.js 的途中，遇到了：</p>
<blockquote>
<p>fatal: unable to access &#x27;<a href="https://github.com/cnpm/nvm.git/" target="_blank" rel="noopener noreferrer">https://github.com/cnpm/nvm.git/</a>&#x27;: Encountered end of file</p>
</blockquote>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">原因</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">阿里云服务器未开启</span><span class="token number" style="color:#36acaa">443</span><span class="token plain">端口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">执行以下的代码：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">需要开启防火墙 systemctl start firewalld</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">firewall</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cmd </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">zone</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">add</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">443</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">tcp </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">permanent # 添加 </span><span class="token number" style="color:#36acaa">443</span><span class="token plain"> 端口访问</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">firewall</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cmd </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">reload # 重新加载让配置生效</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">firewall</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cmd </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">zone</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">query</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">443</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">tcp 查看开启情况，返回 yes 说明已开启。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>对应的解决方案可以参阅：<a href="https://www.cnblogs.com/pangya/p/15735974.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/pangya/p/15735974.html</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安装-mongodb">安装 Mongodb<a href="#安装-mongodb" class="hash-link" aria-label="Direct link to 安装 Mongodb" title="Direct link to 安装 Mongodb">​</a></h2>
<p>由于我们更换了操作系统，所以安装 Mongodb 的方式也和之前有所不同。</p>
<p>首先需要明确的一点：</p>
<p>Alibaba Cloud Linux 2 对应的是 CentOS7</p>
<p>Alibaba Cloud Linux 3 对应的是 CentOS8</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="添加yum源">添加yum源<a href="#添加yum源" class="hash-link" aria-label="Direct link to 添加yum源" title="Direct link to 添加yum源">​</a></h4>
<p>我这里使用的是yum命令安装，需要先添加yum源：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">etc</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yum</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">repos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">d</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">org</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5.0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">repo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后将如下内容添加进去：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">org</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5.0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">MongoDB</span><span class="token plain"> </span><span class="token maybe-class-name">Repository</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baseurl</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">repo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mongodb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">org</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yum</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">redhat</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">$releasever</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">org</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">5.0</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">x86_64</span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpgcheck</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpgkey</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">www</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mongodb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">org</span><span class="token operator" style="color:#393A34">/</span><span class="token keyword" style="color:#00009f">static</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">pgp</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">server</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5.0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">asc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>在 vi 中，按键盘的 i 键是插入内容，插入完毕后按 ESC 退出，然后输入 <!-- -->:wq<!-- --> 保存</p>
</blockquote>
<p>按照官方文档添加了yum源文件，但是当执行<code>yum install -y mongodb-org</code>命令的时候报错了：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token known-class-name class-name">Error</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Failed</span><span class="token plain"> to download metadata </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> repo </span><span class="token string" style="color:#e3116c">&#x27;mongodb-org-5.0&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Cannot</span><span class="token plain"> download repomd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">xml</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Status</span><span class="token plain"> code</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">404</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">repo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mongodb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">org</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yum</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">redhat</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">org</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">5.0</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">x86_64</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">repodata</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">repomd</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">xml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>解决办法就是将<code>$releasever</code>变量直接修改为Centos的版本 7，如下：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">org</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5.0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token maybe-class-name">MongoDB</span><span class="token plain"> </span><span class="token maybe-class-name">Repository</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">baseurl</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">repo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mongodb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">org</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yum</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">redhat</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">7</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongodb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">org</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">5.0</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">x86_64</span><span class="token operator" style="color:#393A34">/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpgcheck</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enabled</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gpgkey</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">www</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">mongodb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">org</span><span class="token operator" style="color:#393A34">/</span><span class="token keyword" style="color:#00009f">static</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">pgp</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">server</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">5.0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">asc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>操作截图如下：</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/IbrJ6yPhHTpeCKv.png" alt="image-20220329122049124" class="img_ev3q"></p>
<p>修改完后再次执行如下命令：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yum install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">y mongodb</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">org</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>MongoDB就能安装成功了。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="启动-mongodb">启动 Mongodb<a href="#启动-mongodb" class="hash-link" aria-label="Direct link to 启动 Mongodb" title="Direct link to 启动 Mongodb">​</a></h4>
<p>安装完成后，使用<code>systemctl</code>命令启动MongoDB服务：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl start mongod  #启动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl status mongod #查看状态</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart mongod #重新启动</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>具体操作如下图：</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/9s2R3A6gbDVX1QC.png" alt="image-20220329122256430" class="img_ev3q"></p>
<p>通过查看状态命令，很多信息都能看到。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="远程连接">远程连接<a href="#远程连接" class="hash-link" aria-label="Direct link to 远程连接" title="Direct link to 远程连接">​</a></h4>
<p>接下来我们来远程连接，记得先把阿里云的安全组的对应端口打开，如下图：</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/qW82LeXkd1fGBZA.png" alt="image-20220329122530816" class="img_ev3q"></p>
<p>点击【配置规则】</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/BGDr8sbpA2JQimv.png" alt="image-20220329122610980" class="img_ev3q"></p>
<p>添加 27017 端口，不把这个端口打开，后期本地电脑无法远程连接数据库</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/Zd9hX7ujDkAO4o3.png" alt="image-20220329122705011" class="img_ev3q"></p>
<p>首先在云端系统输入 mongo，连接上云端的数据库</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/agAPmBFr4nbN58q.png" alt="image-20220329122827638" class="img_ev3q"></p>
<p>步骤和上一个文档一样</p>
<p>为了权限接入可用，必须确保有一个用户是 <em>userAdmin</em> 或者 <em>userAdminAnyDatabase</em> 的角色在 <em>admin</em> 数据库里。
因此，我们首先创建用户 <em>root</em> 用户在 <em>admin</em> 数据库里，代码如下：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use admin # 切换 admin 数据库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">user</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;root&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">pwd</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;123456&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">roles</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">role</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;userAdminAnyDatabase&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;admin&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>具体操作如下图：</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/acBtnWxIybK1fo6.png" alt="image-20220329122940139" class="img_ev3q"></p>
<p>在 <em>mongodb</em> 中 <em>admin</em> 数据库是一个特别的数据库，这个数据库的用户，可以访问 <em>mongodb</em> 中的所有数据库。所以接下来在 <em>admin</em> 数据库上面使用刚才的超级管理员登录，对应代码如下：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use amdin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db.auth(&quot;root&quot;,&quot;123456&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>具体操作如下：</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/keB891ihQ4bECZ6.png" alt="image-20220329123147776" class="img_ev3q"></p>
<p>之后为其他数据库设置用户，步骤也是一样的，首先切换到其他数据库，然后创建用户。</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use 数据库名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createUser</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">user</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;用户名&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">pwd</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;密码&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">roles</span><span class="token operator" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">role</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;read&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;数据库名&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">role</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;readWrite&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token literal-property property" style="color:#36acaa">db</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;数据库名&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>具体操作如下图所示：</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/ecPLF3Zulro14tA.png" alt="image-20220329123632429" class="img_ev3q"></p>
<p>最后执行</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">db</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">auth</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;用户名&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;密码&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>具体操作如下图：</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/k7znmdbRy1r6glE.png" alt="image-20220329123729455" class="img_ev3q"></p>
<p>返回 <em>1</em>，说明登录成功。</p>
<p>至此，我们就在 mysite 数据库上面添加了一个用户，并且设置了账号和密码。</p>
<p>接下来我们来修改 mongodb 的配置文件</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vi </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">etc</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">mongod</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>主要就是将 bingIp 修改为 0.0.0.0 ，这样我们本地的电脑才能访问到</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/1VDKREfOyPABQxH.png" alt="image-20220329130403519" class="img_ev3q"></p>
<p>之后重新启动一下 mongodb，重启命令：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systemctl restart mongod</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后我们在本地的 robo3T 就能连接云端数据库了</p>
<p><img decoding="async" loading="lazy" src="https://s2.loli.net/2025/02/03/dW3AcuMi8GKnJxv.png" alt="image-20220329142328981" class="img_ev3q"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Vue2/20.项目部署.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Vue2/异步组件"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">异步组件</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Vue2/01"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">前端框架的由来</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-项目部署介绍" class="table-of-contents__link toc-highlight">1. 项目部署介绍</a><ul><li><a href="#1-1-后端部署" class="table-of-contents__link toc-highlight">1-1 后端部署</a></li><li><a href="#1-2-前后端分离部署" class="table-of-contents__link toc-highlight">1-2 前后端分离部署</a></li></ul></li><li><a href="#2-部署具体流程" class="table-of-contents__link toc-highlight">2. 部署具体流程</a><ul><li><a href="#2-1-阿里云购买服务器" class="table-of-contents__link toc-highlight">2-1 阿里云购买服务器</a></li><li><a href="#2-2-安装-nodejs" class="table-of-contents__link toc-highlight">2-2 安装 Node.js</a></li><li><a href="#2-3-安装-mongodb" class="table-of-contents__link toc-highlight">2-3 安装 MongoDB</a></li><li><a href="#2-4-上传服务器代码以及数据库数据" class="table-of-contents__link toc-highlight">2-4 上传服务器代码以及数据库数据</a></li><li><a href="#2-5-安装-nginx-静态资源服务器" class="table-of-contents__link toc-highlight">2-5 安装 Nginx 静态资源服务器</a></li><li><a href="#2-6-打包静态资源" class="table-of-contents__link toc-highlight">2-6 打包静态资源</a></li><li><a href="#2-7-进程守护" class="table-of-contents__link toc-highlight">2-7 进程守护</a></li><li><a href="#2-8-域名映射" class="table-of-contents__link toc-highlight">2-8 域名映射</a></li><li><a href="#2-9-数据库加密" class="table-of-contents__link toc-highlight">2-9 数据库加密</a></li></ul></li><li><a href="#数据库恢复数据" class="table-of-contents__link toc-highlight">数据库恢复数据</a></li><li><a href="#centos-linux停止维护后如何应对" class="table-of-contents__link toc-highlight">CentOS Linux停止维护后如何应对？</a></li><li><a href="#安装-mongodb" class="table-of-contents__link toc-highlight">安装 Mongodb</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>